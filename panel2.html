<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>پنل خام هوشمند – درصددهی پیشرفته</title>
  <style>
    body {
      background-color: #111;
      color: #eee;
      font-family: Tahoma, sans-serif;
      padding: 30px;
    }
    .capability {
      margin-bottom: 20px;
      border: 1px solid #444;
      border-radius: 12px;
      padding: 15px;
      background: #1a1a1a;
    }
    input[type="range"] {
      width: 100%;
    }
    .download-btn {
      margin-top: 30px;
      padding: 12px 24px;
      font-size: 18px;
      background-color: #28a745;
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>📦 پنل خام پیشرفته – تزریق از پنل‌ساز</h1>
  <div id="slidersContainer"></div>
  <button class="download-btn" onclick="downloadZip()">⬇️ دریافت فایل خروجی</button>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
  <script>
    // ⛔ کلیدهای محافظت‌شده (با مقدار ثابت)
    const protectedKeys = {
      "fov": "120.0",
      "dynamic_fov": "900.0",
      "version": '"1.0.0"',
      "game_version": '"1.0.0"',
      "file_version": '"1.0.0"',
      "uid": '"0"',
      "user_id": '"0"',
      "token": '"null"',
      "access_key": '"null"',
      "author": '"system"',
      "platform": '"android"'
    };

    const percentMap = {};
    const files = {
  "configcall/DL_Q33.json": "{\n  \"DL_Q33\": {\n    \"enabled\": true,\n    \"supported_weapons\": [\n      \"DL Q33\"\n    ],\n    \"aim_assist_sensitivity\": 1,\n    \"aim_assist_prediction_strength\": 1,\n    \"aim_assist_aim_smoothing\": 1,\n    \"aim_assist_recoil_control\": 1,\n    \"aim_assist_bullet_magnetism\": 1,\n    \"aim_assist_target_acquisition\": 1,\n    \"aim_assist_tracking_precision\": 1,\n    \"aim_bot_enabled\": true,\n    \"aim_bot_target_priority\": \"head\",\n    \"aim_bot_prediction\": 1,\n    \"aim_bot_smoothing\": 1,\n    \"aim_bot_input_delay\": 1,\n    \"aim_bot_lock_on_switch\": true,\n    \"aim_bot_override_bullet_track\": true,\n    \"aim_bot_recoil_control\": 1,\n    \"aim_head_enabled\": true,\n    \"aim_head_sensitivity_multiplier\": 1,\n    \"aim_head_prediction_strength\": 1,\n    \"aim_lock_enabled\": true,\n    \"aim_lock_fov\": 1,\n    \"aim_lock_target_bone\": \"head\",\n    \"aim_lock_smoothness\": 1,\n    \"aim_lock_prediction\": 1,\n    \"aim_lock_tracking_speed\": 1,\n    \"hit_box_enabled\": true,\n    \"hit_box_expand_head\": 1,\n    \"hit_box_expand_chest\": 1,\n    \"hit_box_expand_limbs\": 1,\n    \"hit_box_priority_zones\": [\n      \"head\",\n      \"chest\"\n    ],\n    \"hit_box_dynamic_adjustment\": true,\n    \"bullet_track_enabled\": true,\n    \"bullet_track_prediction_strength\": 1,\n    \"no_recoil_enabled\": true,\n    \"no_recoil_compensation_force\": 1,\n    \"no_recoil_horizontal_stabilization\": 1,\n    \"no_recoil_vertical_stabilization\": 1,\n    \"anti_ban_adaptive_error_rate\": 1,\n    \"anti_ban_false_negative_rate\": 1\n  }\n}",
  "configcall/HS0405-Songstress.json": "{\n  \"HS0405-Songstress\": {\n    \"enabled\": true,\n    \"aim_assist_sensitivity\": 1,\n    \"aim_assist_prediction_strength\": 1,\n    \"aim_assist_aim_smoothing\": 1,\n    \"aim_assist_recoil_control\": 1,\n    \"aim_assist_bullet_magnetism\": 1,\n    \"aim_assist_target_acquisition\": 1,\n    \"aim_assist_tracking_precision\": 1,\n    \"aim_bot_enabled\": true,\n    \"aim_bot_target_priority\": \"head\",\n    \"aim_bot_prediction\": 1,\n    \"aim_bot_smoothing\": 1,\n    \"aim_bot_input_delay\": 1,\n    \"aim_bot_lock_on_switch\": true,\n    \"aim_bot_override_bullet_track\": true,\n    \"aim_bot_recoil_control\": 1,\n    \"aim_head_enabled\": true,\n    \"aim_head_sensitivity_multiplier\": 1,\n    \"aim_head_prediction_strength\": 1,\n    \"hit_box_enabled\": true,\n    \"hit_box_expand_head\": 1,\n    \"hit_box_expand_chest\": 1,\n    \"hit_box_expand_limbs\": 1,\n    \"hit_box_priority_zones\": [\"head\", \"chest\"],\n    \"hit_box_dynamic_adjustment\": true,\n    \"no_recoil_enabled\": true,\n    \"no_recoil_compensation_force\": 1,\n    \"no_recoil_horizontal_stabilization\": 1,\n    \"no_recoil_vertical_stabilization\": 1,\n    \"aim_lock_enabled\": true,\n    \"aim_lock_fov\": 1,\n    \"aim_lock_target_bone\": \"head\",\n    \"aim_lock_smoothness\": 1,\n    \"aim_lock_prediction\": 1,\n    \"aim_lock_tracking_speed\": 1,\n    \"bullet_track_enabled\": true,\n    \"bullet_track_prediction_strength\": 1,\n    \"anti_ban_adaptive_error_rate\": 1,\n    \"anti_ban_false_negative_rate\": 1\n  }\n}",
  "configcall/aim_assist.json": "{\n  \"aim_assist\": {\n    \"enabled\": true,\n    \"sensitivity_multiplier\": 1,\n    \"prediction_strength\": 1,\n    \"aim_smoothing\": 1,\n    \"recoil_control\": 1,\n    \"bullet_magnetism\": 1,\n    \"target_acquisition\": 1,\n    \"tracking_precision\": 1,\n    \"auto_calibration\": true,\n    \"dynamic_fov\": 1,\n    \"activation_key\": \"default\",\n    \"override_bullet_track\": true,\n    \"input_delay\": 1,\n    \"randomized_error\": 1,\n    \"anti_ban\": {\n      \"adaptive_error_rate\": 1,\n      \"false_negative_rate\": 1\n    }\n  }\n}",
  "configcall/aim_bot.json": "{\n  \"aim_bot\": {\n    \"enabled\": true,\n    \"target_priority\": \"head\",\n    \"prediction\": 1,\n    \"smoothing\": 1,\n    \"input_delay\": 1,\n    \"fov_dynamic\": true,\n    \"lock_on_switch\": true,\n    \"micro_adjust_variance\": 1,\n    \"humanize_shot_delay\": false,\n    \"override_bullet_track\": true,\n    \"recoil_control\": 1,\n    \"anti_ban\": {\n      \"adaptive_error_rate\": 1,\n      \"false_negative_rate\": 1\n    }\n  }\n}",
  "configcall/aim_head.json": "{\n  \"aim_head\": {\n    \"enabled\": true,\n    \"sensitivity_multiplier\": 1,\n    \"prediction_strength\": 1,\n    \"aim_smoothing\": 1,\n    \"recoil_control\": 1,\n    \"tracking_precision\": 1,\n    \"auto_calibration\": true,\n    \"dynamic_fov\": 1,\n    \"lock_on_bone\": \"head\",\n    \"max_range\": 1,\n    \"fire_on_lock\": true,\n    \"input_delay\": 1,\n    \"randomized_error\": 1,\n    \"anti_ban\": {\n      \"adaptive_error_rate\": 1,\n      \"false_negative_rate\": 1\n    }\n  }\n}",
  "configcall/aim_lock.json": "{\n  \"aim_lock\": {\n    \"enabled\": true,\n    \"fov\": 1,\n    \"target_bone\": \"head\",\n    \"smoothness\": 1,\n    \"prediction\": 1,\n    \"tracking_speed\": 1,\n    \"input_delay\": 1,\n    \"recoil_control\": 1,\n    \"override_bullet_track\": true,\n    \"lock_priority\": \"closest_center\",\n    \"anti_shake\": true,\n    \"frame_sync\": true,\n    \"randomized_error\": 1,\n    \"anti_ban\": {\n      \"adaptive_error_rate\": 1,\n      \"false_negative_rate\": 1\n    }\n  }\n}",
  "configcall/ak_117.json": "{\n  \"AK_117\": {\n    \"enabled\": true,\n    \"aim_assist_sensitivity\": 1,\n    \"aim_assist_prediction_strength\": 1,\n    \"aim_assist_aim_smoothing\": 1,\n    \"aim_assist_recoil_control\": 1,\n    \"aim_assist_bullet_magnetism\": 1,\n    \"aim_assist_target_acquisition\": 1,\n    \"aim_assist_tracking_precision\": 1,\n    \"aim_bot_enabled\": true,\n    \"aim_bot_target_priority\": \"head\",\n    \"aim_bot_prediction\": 1,\n    \"aim_bot_smoothing\": 1,\n    \"aim_bot_input_delay\": 1,\n    \"aim_bot_lock_on_switch\": true,\n    \"aim_bot_override_bullet_track\": true,\n    \"aim_bot_recoil_control\": 1,\n    \"aim_head_enabled\": true,\n    \"aim_head_sensitivity_multiplier\": 1,\n    \"aim_head_prediction_strength\": 1,\n    \"hit_box_enabled\": true,\n    \"hit_box_expand_head\": 1,\n    \"hit_box_expand_chest\": 1,\n    \"hit_box_expand_limbs\": 1,\n    \"hit_box_priority_zones\": [\"head\", \"chest\"],\n    \"hit_box_dynamic_adjustment\": true,\n    \"no_recoil_enabled\": true,\n    \"no_recoil_compensation_force\": 1,\n    \"no_recoil_horizontal_stabilization\": 1,\n    \"no_recoil_vertical_stabilization\": 1,\n    \"aim_lock_enabled\": true,\n    \"aim_lock_fov\": 1,\n    \"aim_lock_target_bone\": \"head\",\n    \"aim_lock_smoothness\": 1,\n    \"aim_lock_prediction\": 1,\n    \"aim_lock_tracking_speed\": 1,\n    \"bullet_track_enabled\": true,\n    \"bullet_track_prediction_strength\": 1,\n    \"anti_ban_adaptive_error_rate\": 1,\n    \"anti_ban_false_negative_rate\": 1\n  }\n}",
  "configcall/bullet_track.json": "{\n  \"bullet_track\": {\n    \"enabled\": true,\n    \"prediction_strength\": 1,\n    \"target_stickiness\": 1,\n    \"latency_compensation\": true,\n    \"velocity_match\": 1,\n    \"hit_lead_factor\": 1,\n    \"auto_adjust_ping_range\": true,\n    \"hit_scan_accuracy\": 1,\n    \"curve_following\": true,\n    \"tracking_sensitivity\": 1,\n    \"bullet_redirect_radius\": 1,\n    \"penetration_compensation\": true,\n    \"wall_soft_redirect\": true,\n    \"wall_hard_snap\": false,\n    \"enemy_pull_strength\": 1,\n    \"trajectory_override\": true,\n    \"near_miss_snap\": true,\n    \"head_bias\": 1,\n    \"randomized_variation\": 1,\n    \"fire_timing_sync\": true,\n    \"override_aim_assist\": false,\n    \"anti_ban\": {\n      \"adaptive_packet_delay\": false,\n      \"false_detection_avoidance\": 1,\n      \"false_negative_rate\": 1\n    }\n  }\n}",
  "configcall/hit_box.json": "{\n  \"hit_box\": {\n    \"enabled\": true,\n    \"expand_head\": 1,\n    \"expand_chest\": 1,\n    \"expand_limbs\": 1,\n    \"priority_zones\": [\"head\", \"chest\"],\n    \"dynamic_adjustment\": true,\n    \"weapon_specific_scaling\": true,\n    \"apply_on_prediction\": true,\n    \"trigger_on_lock\": true,\n    \"override_default_hitreg\": true,\n    \"compatibility_mode\": \"both\",\n    \"anti_ban\": {\n      \"adaptive_error_rate\": 1,\n      \"false_negative_rate\": 1\n    }\n  }\n}",
  "configcall/master_config.json": "{\n  \"master_config\": {\n    \"version\": \"1.1\",\n    \"description\": \"Season 1 | Optimized for first & third person\",\n    \"modules_enabled\": [\n      \"aim_assist\",\n      \"aim_bot\",\n      \"aim_head\",\n      \"aim_lock\",\n      \"bullet_track\",\n      \"hit_box\",\n      \"no_recoil\",\n      \"no_spread\",\n      \"shotgun_config\",\n      \"master_config\",\n      \"HS0405-Songstress\",\n      \"AK_117\",\n      \"DL_Q33\"\n    ],\n    \"global_settings\": {\n      \"sync_interval\": 1,\n      \"frame_delay\": 1,\n      \"packet_smoothing\": true,\n      \"error_balancer\": true,\n      \"auto_throttle_ping\": true,\n      \"performance_optimizer\": true,\n      \"gpu_render_priority\": \"high\",\n      \"override_conflicts\": true,\n      \"input_pipeline_sync\": true,\n      \"bullet_physics_boost\": true,\n      \"module_fallback_recovery\": true,\n      \"power_scale_multiplier\": 1,\n      \"hybrid_aggression_mode\": true\n    },\n    \"compatibility\": {\n      \"mode\": \"both\",\n      \"game_modes\": [\"battle_royale\", \"multiplayer\"],\n      \"device_type\": \"android_all\",\n      \"map_adjustments\": true,\n      \"weapon_auto_detect\": true,\n      \"ping_range_dynamic\": true,\n      \"game_version\": \"1.1\"\n    }\n  }\n}",
  "configcall/no_recoil.json": "{\n  \"no_recoil\": {\n    \"enabled\": true,\n    \"recoil_pattern_override\": true,\n    \"recoil_compensation_force\": 1,\n    \"horizontal_stabilization\": 1,\n    \"vertical_stabilization\": 1,\n    \"auto_tune_weapon_type\": true,\n    \"dynamic_recoil_adapt\": true,\n    \"burst_fire_sync\": true,\n    \"micro_adjust_randomness\": 1,\n    \"firing_rate_sync\": true,\n    \"frame_delay\": 1,\n    \"anti_ban\": {\n      \"adaptive_error_blend\": 1,\n      \"false_positive_evasion\": 1,\n      \"false_negative_rate\": 1\n    }\n  }\n}",
  "configcall/no_spread.json": "{\n  \"no_spread\": {\n    \"enabled\": true,\n    \"spread_reduction_factor\": 1,\n    \"spread_control_precision\": 1,\n    \"dynamic_spread_adaptation\": true,\n    \"weapon_specific_tuning\": true,\n    \"auto_adjust_fire_mode\": true,\n    \"micro_variation_randomness\": 1,\n    \"frame_sync_optimization\": true,\n    \"anti_ban\": {\n      \"adaptive_error_blend\": 1,\n      \"false_positive_evasion\": 1,\n      \"false_negative_rate\": 1\n    }\n  }\n}",
  "configcall/shotgun_config.json": "{\n  \"shotgun_config\": {\n    \"enabled\": true,\n    \"supported_weapons\": [\n      \"HS0405\",\n      \"BY15\",\n      \"KRM262\",\n      \"Striker\",\n      \"Echo\",\n      \"R9-0\"\n    ]\n  },\n  \"shotgun_custom_config\": {\n    \"enabled\": true,\n    \"aim_assist_sensitivity\": 1,\n    \"aim_assist_prediction_strength\": 1,\n    \"aim_assist_aim_smoothing\": 1,\n    \"aim_assist_recoil_control\": 1,\n    \"aim_assist_bullet_magnetism\": 1,\n    \"aim_assist_target_acquisition\": 1,\n    \"aim_assist_tracking_precision\": 1,\n    \n    \"aim_bot_enabled\": true,\n    \"aim_bot_target_priority\": \"chest\",\n    \"aim_bot_prediction\": 1,\n    \"aim_bot_smoothing\": 1,\n    \"aim_bot_input_delay\": 1,\n    \"aim_bot_lock_on_switch\": true,\n    \"aim_bot_override_bullet_track\": true,\n    \"aim_bot_recoil_control\": 1,\n\n    \"aim_head_enabled\": true,\n    \"aim_head_sensitivity_multiplier\": 1,\n    \"aim_head_prediction_strength\": 1,\n\n    \"hit_box_enabled\": true,\n    \"hit_box_expand_head\": 1,\n    \"hit_box_expand_chest\": 1,\n    \"hit_box_expand_limbs\": 1,\n    \"hit_box_priority_zones\": [\"chest\", \"head\"],\n    \"hit_box_dynamic_adjustment\": true,\n\n    \"no_recoil_enabled\": true,\n    \"no_recoil_compensation_force\": 1,\n    \"no_recoil_horizontal_stabilization\": 1,\n    \"no_recoil_vertical_stabilization\": 1,\n\n    \"aim_lock_enabled\": true,\n    \"aim_lock_fov\": 1,\n    \"aim_lock_target_bone\": \"chest\",\n    \"aim_lock_smoothness\": 1,\n    \"aim_lock_prediction\": 1,\n    \"aim_lock_tracking_speed\": 1,\n\n    \"bullet_track_enabled\": true,\n    \"bullet_track_prediction_strength\": 1,\n\n    \"anti_ban_adaptive_error_rate\": 1,\n    \"anti_ban_false_negative_rate\": 1\n  }\n}"
};  // 🔁 اینجا پنل‌ساز فایل‌ها را وارد می‌کند

    function buildSlidersFromFiles(fileMap) {
      const container = document.getElementById("slidersContainer");
      container.innerHTML = "";
      const uniqueKeys = new Set();

      for (const [fileName, content] of Object.entries(fileMap)) {
        const matches = [...content.matchAll(/["']?([a-zA-Z0-9_]+)["']?\s*[:=]\s*[-+]?[0-9]*\.?[0-9]+/g)];
        matches.forEach(m => {
          const key = m[1].toLowerCase();
          if (!protectedKeys.hasOwnProperty(key)) {
            uniqueKeys.add(key);
          }
        });
      }

      uniqueKeys.forEach(key => {
        const cap = document.createElement("div");
        cap.className = "capability";
        cap.innerHTML = `
          <h2>${key}</h2>
          <input type="range" min="0" max="1000" value="100" id="${key}_range" oninput="${key}_label.innerText = this.value + '%'">
          <label id="${key}_label">100%</label>
        `;
        container.appendChild(cap);
        percentMap[key] = 100;
      });
    }

    function downloadZip() {
      const sliders = document.querySelectorAll("input[type='range']");
      sliders.forEach(slider => {
        const key = slider.id.replace("_range", "");
        percentMap[key] = parseFloat(slider.value);
      });

      const zip = new JSZip();

      for (const [fileName, content] of Object.entries(files)) {
        const modified = content.replace(/(["']?)([a-zA-Z0-9_]+)\1\s*[:=]\s*([-+]?[0-9]*\.?[0-9]+)/g, (match, quote, key, val) => {
          const lowerKey = key.toLowerCase();
          if (protectedKeys.hasOwnProperty(lowerKey)) {
            return `${quote}${key}${quote}: ${protectedKeys[lowerKey]}`;
          }
          const percent = percentMap[lowerKey] ?? 100;
          return `${quote}${key}${quote}: ${(parseFloat(val) * percent / 100).toFixed(6)}`;
        });

        zip.file(fileName, modified);
      }

      zip.generateAsync({ type: "blob" }).then(blob => {
        const a = document.createElement("a");
        a.href = URL.createObjectURL(blob);
        a.download = "output_config.zip";
        a.click();
      });
    }

    // ✅ نمونه تست (در استفاده واقعی این قسمت توسط پنل‌ساز جایگزین می‌شود)
    files["aim_assist.json"] = `
    {
      "enabled": true,
      "aim_power": 1.0,
      "fov": 150.0,
      "dynamic_fov": 800.0
    }`;

    files["damage_boost.ini"] = `
    damage_multiplier = 1.0
    fov = 180.0
    `;

    // ⏳ ساخت اولیه اسلایدرها
    buildSlidersFromFiles(files);
  </script>
</body>
</html>